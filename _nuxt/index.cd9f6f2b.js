import{c as k,_ as C}from"./Navbar.0f0e4624.js";import{_ as w}from"./Container.856f971b.js";import{a as M,q as N,p as $,m as V,a4 as B,s as u,x as A,y as I,o as m,b as p,f as c,i as _,e as t,u as o,B as v,D as f,A as E}from"./entry.b980ff2a.js";import{u as L}from"./index.b7543822.js";import{m as S}from"./marked.esm.c4f1ef09.js";import"./nuxt-link.60028201.js";import"./Dialog.876fc127.js";import"./LoadingSvg.54a92436.js";var T=k("edit-circle","IconEditCircle",[["path",{d:"M12 15l8.385 -8.415a2.1 2.1 0 0 0 -2.97 -2.97l-8.415 8.385v3h3z",key:"svg-0"}],["path",{d:"M16 5l3 3",key:"svg-1"}],["path",{d:"M9 7.07a7 7 0 0 0 1 13.93a7 7 0 0 0 6.929 -6",key:"svg-2"}]]);const q={class:"page-admin"},D=t("span",null,"管理",-1),G=t("div",{class:"mb-4 text-xl font-bold"},"发送通知",-1),H={class:"mb-4 text-sm"},R=t("label",{for:"notice-title",class:"mb-2 block"},"标题",-1),U={class:"mb-4 text-sm"},z=t("label",{for:"notice-title",class:"mb-2 block"},"内容",-1),F={key:0,class:"mb-4 text-sm"},j=t("div",{class:"mb-2 block"},"预览",-1),J=["innerHTML"],et=M({__name:"index",setup(K){const{$toast:a}=N(),n=L(),r=$(),b=V();B(()=>{b.query.vin!=="vin"&&localStorage.getItem("vin")!=="vin"?r.replace("/"):(localStorage.setItem("vin","vin"),r.replace("/vin"))});const e=u({title:"",content:""}),d=A(()=>S(e.value.content));async function h(){if(!e.value.title||!e.value.content){a.error("标题和内容不能为空");return}n.$state.loading=!0;try{await n.apiAppCreateNotice({title:e.value.title,content:e.value.content}),e.value.title="",e.value.content="",a.success("发送通知成功"),n.$state.loading=!1}catch(s){a.error(`发送通知失败：${s}`),n.$state.loading=!1}}const x=u([]);return I(()=>{n.apiAppGetNotices().then(s=>{x.value=s.data}).catch(s=>{console.log(s),a.error("获取通知列表失败")})}),(s,l)=>{const g=C,y=w;return m(),p("div",q,[c(g,{shadow:"",fixed:""},{"nav-center":_(()=>[c(o(T)),D]),_:1}),t("main",null,[c(y,{class:"notice-box"},{default:_(()=>[G,t("div",null,[t("div",H,[R,v(t("input",{"onUpdate:modelValue":l[0]||(l[0]=i=>o(e).title=i),id:"notice-title",class:"w-full",type:"text",placeholder:"请输入通知标题"},null,512),[[f,o(e).title]])]),t("div",U,[z,v(t("textarea",{rows:"10","onUpdate:modelValue":l[1]||(l[1]=i=>o(e).content=i),id:"notice-title",class:"w-full",placeholder:"请输入通知内容"},null,512),[[f,o(e).content]])]),o(d)?(m(),p("div",F,[j,t("div",{class:"prose max-w-none rounded-md border border-gray-300 p-4",innerHTML:o(d)},null,8,J)])):E("",!0),t("div",{class:"mb-4 text-sm"},[t("button",{onClick:h,class:"button button-theme"},"立即发送")])])]),_:1})])])}}});export{et as default};
